<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<title>会员中心</title>
	<link rel="stylesheet" href="/static/admin/assets/css/layui.css">
	<link rel="stylesheet" type="text/css" id="css" href="/static/home/css/user.css">
	<script type="text/javascript" src="/static/admin/js/jquery1.8.3.min.js"></script>
	<script type="text/javascript" src="/static/admin/assets/layui.all.js"></script>
	<style type="text/css"> 
	.layui-form-label {width: 120px}
	.layui-input, .layui-textarea {width: 40%;}
	</style>
</head>
<body>
<div id="lay-body">
	<div class="layui-layout layui-layout-admin">
{include file="public/member"}	
<div class="layadmin-body-shade"></div>
		<div class="layui-body">
	<div class="layui-card">
		<div class="layui-card-header">
			<div class="layui-tab layui-tab-brief">
				密码修改
			</div> 
		</div>
		<div class="layui-card-body">
			<hr style="margin:20px 0"/>
			<form  class="layui-form"  action="" id="carform" >
			<div>
				<input type="hidden" name="checkname" value="{:session('front_name')}">
				<div class="layui-form-item">
					<label class="layui-form-label">原密码</label>
					<div class="layui-input-block">
						<input type="password" lay-verify="required" class="layui-input" name="first" value=""/>
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">新密码</label>
					<div class="layui-input-block">
						<input  type="password" lay-verify="required" class="layui-input " name="next" value=""/>
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">再次输入密码</label>
					<div class="layui-input-block">
						<input type="password" lay-verify="required" class="layui-input" name="checkcode" value=""/>
					</div>
				</div>

				<div class="layui-form-item">
					<label class="layui-form-label"></label>
					<div class="layui-input-inline">
						<input type="submit" value="提交修改" lay-submit class="layui-btn layui-btn-normal">
					</div>
				</div>
			</div>
	</form>
</body>

{include file="public/validate"}

<script type="text/javascript">
				//上传图片
				
	//验证 用户名，密码，上传图不为空

    $("#carform").validate({
      submitHandler:function(form){
      	var pwd = $("input[name=next]").val();
      	if(!/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,16}$/.test(pwd)){
					layer.tips("密码不符合要求","input[name=next]",{time:1500,tips:[2,"#F13D3D"]});
					return false;
				}
            var checkcode = $("input[name=checkcode").val();
            if(!(pwd == checkcode)){
            	layer.tips('两次密码不一致','input[name=checkcode]');
              return false;
            }
        $(form).ajaxSubmit({
          type:"post",
          url:"{:url('home/Ucenter/checkcode')}",
          dataType:"json",
          success:function(res){
              if(res.code == 1){
                layer.msg(res.msg,{icon:1,time:1500},function(){
                    //关闭本窗口，刷新父级页面
                      location.href="{:url('home/Login/login')}";
                  })
              }else{
                layer.msg(res.msg,{icon:2,time:1500});
              }
          }
        })
      }
    })
</script>
</html>